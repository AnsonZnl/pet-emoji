# 分析跟踪配置

## 概述

网站已集成Google Analytics和百度统计，用于跟踪用户行为和网站性能。

## 跟踪代码

### Google Analytics (GA4)
- **跟踪ID**: G-8DLLXRJE57
- **实现方式**: 使用Next.js Script组件
- **策略**: afterInteractive（页面交互后加载）

### 百度统计
- **跟踪ID**: 2ce585156b064596497db11bbd4ff3b2
- **实现方式**: 使用Next.js Script组件
- **策略**: afterInteractive（页面交互后加载）

## 自定义事件跟踪

### 1. 文件上传事件
```javascript
gtag('event', 'file_upload', {
  event_category: 'engagement',
  event_label: 'pet_photo_uploaded',
  value: fileSizeInKB
});
```

### 2. 表情生成事件
#### 生成开始
```javascript
gtag('event', 'emoji_generation_start', {
  event_category: 'engagement',
  event_label: 'style_cute', // 或其他风格
  value: 1
});
```

#### 生成成功
```javascript
gtag('event', 'emoji_generation_success', {
  event_category: 'conversion',
  event_label: 'style_cute',
  value: 1
});
```

#### 生成失败
```javascript
gtag('event', 'emoji_generation_error', {
  event_category: 'error',
  event_label: 'style_cute',
  value: 0
});
```

### 3. 下载事件
#### 下载开始
```javascript
gtag('event', 'emoji_download_start', {
  event_category: 'engagement',
  event_label: 'style_cute',
  value: 1
});
```

#### 下载成功
```javascript
gtag('event', 'emoji_download_success', {
  event_category: 'conversion',
  event_label: 'style_cute',
  value: 1
});
```

#### 下载失败
```javascript
gtag('event', 'emoji_download_error', {
  event_category: 'error',
  event_label: 'download_failed',
  value: 0
});
```

## 事件分类说明

### Engagement（参与度）
- `file_upload`: 文件上传
- `emoji_generation_start`: 表情生成开始
- `emoji_download_start`: 下载开始

### Conversion（转化）
- `emoji_generation_success`: 表情生成成功
- `emoji_download_success`: 下载成功

### Error（错误）
- `emoji_generation_error`: 表情生成失败
- `emoji_download_error`: 下载失败

## 数据分析建议

### Google Analytics 4
1. **实时报告**: 查看实时用户活动
2. **事件报告**: 分析自定义事件触发情况
3. **转化报告**: 跟踪表情生成和下载转化率
4. **受众报告**: 了解用户特征和来源

### 百度统计
1. **实时访客**: 查看当前访问情况
2. **趋势分析**: 分析访问量变化趋势
3. **来源分析**: 了解用户来源渠道
4. **受访页面**: 分析页面访问情况

## 隐私合规

### GDPR合规
- 使用Google Analytics 4的隐私友好配置
- 考虑添加Cookie同意横幅
- 提供用户选择退出的选项

### 中国合规
- 百度统计符合中国相关法规
- 数据存储在中国境内

## 性能优化

### 加载策略
- 使用`afterInteractive`策略确保不阻塞页面渲染
- 脚本在用户交互后才加载，提升页面性能

### 错误处理
- 所有跟踪代码都有错误处理
- 跟踪失败不会影响网站功能

## 维护说明

### 定期检查
1. 验证跟踪代码正常工作
2. 检查事件数据准确性
3. 监控网站性能影响

### 更新跟踪
如需添加新的跟踪事件，请在相关组件中添加相应的gtag调用。

### 测试环境
在开发环境中，跟踪代码仍然会执行，但可以通过Google Analytics的实时报告进行测试验证。
